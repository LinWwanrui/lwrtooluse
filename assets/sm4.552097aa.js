import{r as B}from"./___vite-browser-external_commonjs-proxy.b7c1514d.js";import{h as A}from"./index.20f86bbc.js";var m={};m.byteLength=L;m.toByteArray=K;m.fromByteArray=S;var y=[],l=[],C=typeof Uint8Array<"u"?Uint8Array:Array,T="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var p=0,F=T.length;p<F;++p)y[p]=T[p],l[T.charCodeAt(p)]=p;l["-".charCodeAt(0)]=62;l["_".charCodeAt(0)]=63;function U(n){var e=n.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var t=n.indexOf("=");t===-1&&(t=e);var r=t===e?0:4-t%4;return[t,r]}function L(n){var e=U(n),t=e[0],r=e[1];return(t+r)*3/4-r}function E(n,e,t){return(e+t)*3/4-t}function K(n){var e,t=U(n),r=t[0],o=t[1],a=new C(E(n,r,o)),x=0,i=o>0?r-4:r,c;for(c=0;c<i;c+=4)e=l[n.charCodeAt(c)]<<18|l[n.charCodeAt(c+1)]<<12|l[n.charCodeAt(c+2)]<<6|l[n.charCodeAt(c+3)],a[x++]=e>>16&255,a[x++]=e>>8&255,a[x++]=e&255;return o===2&&(e=l[n.charCodeAt(c)]<<2|l[n.charCodeAt(c+1)]>>4,a[x++]=e&255),o===1&&(e=l[n.charCodeAt(c)]<<10|l[n.charCodeAt(c+1)]<<4|l[n.charCodeAt(c+2)]>>2,a[x++]=e>>8&255,a[x++]=e&255),a}function R(n){return y[n>>18&63]+y[n>>12&63]+y[n>>6&63]+y[n&63]}function N(n,e,t){for(var r,o=[],a=e;a<t;a+=3)r=(n[a]<<16&16711680)+(n[a+1]<<8&65280)+(n[a+2]&255),o.push(R(r));return o.join("")}function S(n){for(var e,t=n.length,r=t%3,o=[],a=16383,x=0,i=t-r;x<i;x+=a)o.push(N(n,x,x+a>i?i:x+a));return r===1?(e=n[t-1],o.push(y[e>>2]+y[e<<4&63]+"==")):r===2&&(e=(n[t-2]<<8)+n[t-1],o.push(y[e>>10]+y[e>>4&63]+y[e<<2&63]+"=")),o.join("")}const w=m;class j{static stringToArrayBufferInUtf8(e){const t=typeof window>"u"?B.TextEncoder:window.TextEncoder;return new t().encode(e)}static utf8ArrayBufferToString(e){const t=typeof window>"u"?B.TextDecoder:window.TextDecoder;return new t("utf-8").decode(e)}static arrayBufferToBase64(e){return w.fromByteArray(e)}static base64ToArrayBuffer(e){return w.toByteArray(e)}}var $=j;const u=$,s=16,v=Uint8Array.from([214,144,233,254,204,225,61,183,22,182,20,194,40,251,44,5,43,103,154,118,42,190,4,195,170,68,19,38,73,134,6,153,156,66,80,244,145,239,152,122,51,84,11,67,237,207,172,98,228,179,28,169,201,8,232,149,128,223,148,250,117,143,63,166,71,7,167,252,243,115,23,186,131,89,60,25,230,133,79,168,104,107,129,178,113,100,218,139,248,235,15,75,112,86,157,53,30,36,14,94,99,88,209,162,37,34,124,59,1,33,120,135,212,0,70,87,159,211,39,82,76,54,2,231,160,196,200,158,234,191,138,210,64,199,56,181,163,247,242,206,249,97,21,161,224,174,93,164,155,52,26,85,173,147,50,48,245,140,177,227,29,246,226,46,130,102,202,96,192,41,35,171,13,83,78,111,213,219,55,69,222,253,142,47,3,255,106,114,109,108,91,81,141,27,175,146,187,221,188,127,17,217,92,65,31,16,90,216,10,193,49,136,165,205,123,189,45,116,208,18,184,229,180,176,137,105,151,74,12,150,119,126,101,185,241,9,197,110,198,132,24,240,125,236,58,220,77,32,121,238,95,62,215,203,57,72]),H=Uint32Array.from([462357,472066609,943670861,1415275113,1886879365,2358483617,2830087869,3301692121,3773296373,4228057617,404694573,876298825,1347903077,1819507329,2291111581,2762715833,3234320085,3705924337,4177462797,337322537,808926789,1280531041,1752135293,2223739545,2695343797,3166948049,3638552301,4110090761,269950501,741554753,1213159005,1684763257]),k=Uint32Array.from([2746333894,1453994832,1736282519,2993693404]);class O{constructor(e){let t=u.stringToArrayBufferInUtf8(e.key);if(t.length!==16)throw new Error("key should be a 16 bytes string");this.key=t;let r=new Uint8Array(0);if(e.iv!==void 0&&e.iv!==null&&(r=u.stringToArrayBufferInUtf8(e.iv),r.length!==16))throw new Error("iv should be a 16 bytes string");this.iv=r,this.mode="cbc",["cbc","ecb"].indexOf(e.mode)>=0&&(this.mode=e.mode),this.cipherType="base64",["base64","text"].indexOf(e.outType)>=0&&(this.cipherType=e.outType),this.encryptRoundKeys=new Uint32Array(32),this.spawnEncryptRoundKeys(),this.decryptRoundKeys=Uint32Array.from(this.encryptRoundKeys),this.decryptRoundKeys.reverse()}doBlockCrypt(e,t){let r=new Uint32Array(36);r.set(e,0);for(let a=0;a<32;a++)r[a+4]=r[a]^this.tTransform1(r[a+1]^r[a+2]^r[a+3]^t[a]);let o=new Uint32Array(4);return o[0]=r[35],o[1]=r[34],o[2]=r[33],o[3]=r[32],o}spawnEncryptRoundKeys(){let e=new Uint32Array(4);e[0]=this.key[0]<<24|this.key[1]<<16|this.key[2]<<8|this.key[3],e[1]=this.key[4]<<24|this.key[5]<<16|this.key[6]<<8|this.key[7],e[2]=this.key[8]<<24|this.key[9]<<16|this.key[10]<<8|this.key[11],e[3]=this.key[12]<<24|this.key[13]<<16|this.key[14]<<8|this.key[15];let t=new Uint32Array(36);t[0]=e[0]^k[0],t[1]=e[1]^k[1],t[2]=e[2]^k[2],t[3]=e[3]^k[3];for(let r=0;r<32;r++)t[r+4]=t[r]^this.tTransform2(t[r+1]^t[r+2]^t[r+3]^H[r]),this.encryptRoundKeys[r]=t[r+4]}rotateLeft(e,t){return e<<t|e>>>32-t}linearTransform1(e){return e^this.rotateLeft(e,2)^this.rotateLeft(e,10)^this.rotateLeft(e,18)^this.rotateLeft(e,24)}linearTransform2(e){return e^this.rotateLeft(e,13)^this.rotateLeft(e,23)}tauTransform(e){return v[e>>>24&255]<<24|v[e>>>16&255]<<16|v[e>>>8&255]<<8|v[e&255]}tTransform1(e){let t=this.tauTransform(e);return this.linearTransform1(t)}tTransform2(e){let t=this.tauTransform(e);return this.linearTransform2(t)}padding(e){if(e===null)return null;let t=s-e.length%s,r=new Uint8Array(e.length+t);return r.set(e,0),r.fill(t,e.length),r}dePadding(e){if(e===null)return null;let t=e[e.length-1];return e.slice(0,e.length-t)}uint8ToUint32Block(e,t=0){let r=new Uint32Array(4);return r[0]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],r[1]=e[t+4]<<24|e[t+5]<<16|e[t+6]<<8|e[t+7],r[2]=e[t+8]<<24|e[t+9]<<16|e[t+10]<<8|e[t+11],r[3]=e[t+12]<<24|e[t+13]<<16|e[t+14]<<8|e[t+15],r}encrypt(e){let t=u.stringToArrayBufferInUtf8(e),r=this.padding(t),o=r.length/s,a=new Uint8Array(r.length);if(this.mode==="cbc"){if(this.iv===null||this.iv.length!==16)throw new Error("iv error");let x=this.uint8ToUint32Block(this.iv);for(let i=0;i<o;i++){let c=i*s,d=this.uint8ToUint32Block(r,c);x[0]=x[0]^d[0],x[1]=x[1]^d[1],x[2]=x[2]^d[2],x[3]=x[3]^d[3];let f=this.doBlockCrypt(x,this.encryptRoundKeys);x=f;for(let h=0;h<s;h++)a[c+h]=f[parseInt(h/4)]>>(3-h)%4*8&255}}else for(let x=0;x<o;x++){let i=x*s,c=this.uint8ToUint32Block(r,i),d=this.doBlockCrypt(c,this.encryptRoundKeys);for(let f=0;f<s;f++)a[i+f]=d[parseInt(f/4)]>>(3-f)%4*8&255}return this.cipherType==="base64"?u.arrayBufferToBase64(a):u.utf8ArrayBufferToString(a)}decrypt(e){let t=new Uint8Array;this.cipherType==="base64"?t=u.base64ToArrayBuffer(e):t=u.stringToArrayBufferInUtf8(e);let r=t.length/s,o=new Uint8Array(t.length);if(this.mode==="cbc"){if(this.iv===null||this.iv.length!==16)throw new Error("iv error");let x=this.uint8ToUint32Block(this.iv);for(let i=0;i<r;i++){let c=i*s,d=this.uint8ToUint32Block(t,c),f=this.doBlockCrypt(d,this.decryptRoundKeys),h=new Uint32Array(4);h[0]=x[0]^f[0],h[1]=x[1]^f[1],h[2]=x[2]^f[2],h[3]=x[3]^f[3],x=d;for(let b=0;b<s;b++)o[c+b]=h[parseInt(b/4)]>>(3-b)%4*8&255}}else for(let x=0;x<r;x++){let i=x*s,c=this.uint8ToUint32Block(t,i),d=this.doBlockCrypt(c,this.decryptRoundKeys);for(let f=0;f<s;f++)o[i+f]=d[parseInt(f/4)]>>(3-f)%4*8&255}let a=this.dePadding(o);return u.utf8ArrayBufferToString(a)}}var D=O;const M=D;var g={sm4:M};class P{encrypt(e,t){A.objectUnavailable(t)&&(t="HENG1AN2WEN3YIN4");let r={key:t,mode:"ecb",cipherType:"base64"},o=g.sm4;return o=new o(r),o.encrypt(e)}decrypt(e,t){A.objectUnavailable(t)&&(t="HENG1AN2WEN3YIN4");let r={key:t,mode:"ecb",cipherType:"base64"},o=g.sm4;return o=new o(r),o.decrypt(e)}}const W=new P;export{W as s};
